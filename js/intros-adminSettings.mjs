/*! third party licenses: js/vendor.LICENSE.txt */
import{r as l,t as d,n as p,a as h,b as u,N as g,c as f,d as m,e as o,_ as r,s as _,f as v,g as C,V as c}from"./intros-main.mjs";l(d);const A={name:"HelpCircleIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var k=function(){var s=this,e=s._self._c;return e("span",s._b({staticClass:"material-design-icon help-circle-icon",attrs:{"aria-hidden":s.title?null:"true","aria-label":s.title,role:"img"},on:{click:function(a){return s.$emit("click",a)}}},"span",s.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:s.fillColor,width:s.size,height:s.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M15.07,11.25L14.17,12.17C13.45,12.89 13,13.5 13,15H11V14.5C11,13.39 11.45,12.39 12.17,11.67L13.41,10.41C13.78,10.05 14,9.55 14,9C14,7.89 13.1,7 12,7A2,2 0 0,0 10,9H8A4,4 0 0,1 12,5A4,4 0 0,1 16,9C16,9.88 15.64,10.67 15.07,11.25M13,19H11V17H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"}},[s.title?e("title",[s._v(s._s(s.title))]):s._e()])])])},I=[],b=p(A,k,I,!1,null,null);const w=b.exports,S={name:"NcSettingsSection",components:{HelpCircle:w},props:{name:{type:String,required:!0},description:{type:String,default:""},docUrl:{type:String,default:""},limitWidth:{type:Boolean,default:!0}},data(){return{docNameTranslated:h("External documentation for {name}",{name:this.name})}},computed:{forceLimitWidth(){if(this.limitWidth)return!0;const[s]=window._oc_config?.version.split(".",2)??[];return s&&Number.parseInt(s)>=30},hasDescription(){return this.description.length>0},hasDocUrl(){return this.docUrl.length>0}}};var N=function(){var s=this,e=s._self._c;return e("div",{staticClass:"settings-section",class:{"settings-section--limit-width":s.forceLimitWidth}},[e("h2",{staticClass:"settings-section__name"},[s._v(" "+s._s(s.name)+" "),s.hasDocUrl?e("a",{staticClass:"settings-section__info",attrs:{href:s.docUrl,title:s.docNameTranslated,"aria-label":s.docNameTranslated,target:"_blank",rel:"noreferrer nofollow"}},[e("HelpCircle",{attrs:{size:20}})],1):s._e()]),s.hasDescription?e("p",{staticClass:"settings-section__desc"},[s._v(" "+s._s(s.description)+" ")]):s._e(),s._t("default")],2)},y=[],L=p(S,N,y,!1,null,"6f6953b5");const U=L.exports,x={name:"AdminSettings",components:{NcSettingsSection:U,NcCheckboxRadioSwitch:m,NcButton:f,NcLoadingIcon:g},data(){return{loading:!0,error:!1,checkedApps:[],installedApps:[],intros:null}},computed:{appsList(){return this.getIntrosAppNames()},saveConfigsUrl(){return r("/apps/intros/saveconfs")},getConfigsUrl(){return r("/apps/intros/getconfs")}},async mounted(){this.intros=await C();try{this.installedApps=(await o.get(r("/apps/intros/apps"))).data.ocs.data.apps;const s=await o.get(this.getConfigsUrl),e=[];for(const a in s.data.ocs.data.values)if(a.match("introjs-dontShowAgain-(.*)")){const i=a.match("introjs-dontShowAgain-(.*)")[1];e.push(i),s.data.ocs.data.values[a]==="false"&&this.checkedApps.push(i)}for(const a in this.appsList)e.includes(this.appsList[a].appId)||this.checkedApps.push(this.appsList[a].appId);this.loading=!1}catch(s){this.error=s,this.loading=!1}},methods:{getIntrosAppNames(){return Object.entries(this.intros).map(s=>({appId:s[0],appName:s[1].name??""}))},async onSave(){const s={appConfigs:{}};this.appsList.forEach(e=>{if(e.appId.includes("aside"))return;const a=this.checkedApps.indexOf(e.appId)===-1?"true":"false";s.appConfigs[`introjs-dontShowAgain-${e.appId}`]=a,this.appsList.forEach(i=>{i.appId.includes(e.appId)&&i.appId.includes("aside")&&(s.appConfigs[`introjs-dontShowAgain-${i.appId}`]=a)})});try{const e=await o.put(this.saveConfigsUrl,s);_(e.data.ocs.data.message)}catch(e){v(e.response.data.error_message)}},onEnableAll(){this.appsList.forEach(s=>{this.checkedApps.includes(s.appId)||this.checkedApps.push(s.appId)}),this.onSave()},onDisableAll(){this.checkedApps=[],this.onSave()},async onLinkClick(s){const e={appConfigs:{}};e.appConfigs[`introjs-dontShowAgain-${s}`]="false",await o.put(this.saveConfigsUrl,e);const a=s==="user"?`/settings/${s}`:`/apps/${s}`;window.location.href=r(a)},appIsInstalled(s){return this.installedApps.includes(s.appId)||s.appId==="user"||s.appId==="admin"}}};var j=function(){var s=this,e=s._self._c;return e("div",{attrs:{id:"introjs_settings"}},[e("NcSettingsSection",{attrs:{name:s.t("intros","Intros"),description:s.t("intros","You can choose to enable/disable the tutorial for each app. Check the apps for which you want to see the tutorial and click save, or use the enable/disable all buttons.")}},[s.loading?[e("NcLoadingIcon")]:s.error?[e("p",[s._v(s._s(s.error))])]:[s._l(s.appsList,function(a){return[!a.appId.includes("aside")&&s.appIsInstalled(a)?[e("div",{key:a.appId,staticClass:"check-apps"},[e("NcCheckboxRadioSwitch",{attrs:{checked:s.checkedApps,value:a.appId,name:"checkedApps"},on:{"update:checked":function(i){s.checkedApps=i}}},[s._v(" "+s._s(a.appName.charAt(0).toUpperCase()+a.appName.slice(1))+" ")]),e("div",{staticClass:"link-apps-wrapper"},[e("NcButton",{attrs:{type:"tertiary"},on:{click:function(i){return s.onLinkClick(a.appId)}}},[s._v(" "+s._s(s.t("intros","Go to tutorial"))+" ")])],1)],1)]:s._e()]}),e("div",{staticClass:"save-buttons-wrapper"},[e("NcButton",{attrs:{"aria-label":"Save",type:"primary"},on:{click:s.onSave}},[s._v(" "+s._s(s.t("intros","Save"))+" ")]),e("NcButton",{attrs:{"aria-label":"Reactiveall",type:"secondary"},on:{click:s.onEnableAll}},[s._v(" "+s._s(s.t("intros","Enable all tutorials"))+" ")]),e("NcButton",{attrs:{"aria-label":"Deactivateall",type:"secondary"},on:{click:s.onDisableAll}},[s._v(" "+s._s(s.t("intros","Disable all tutorials"))+" ")])],1)]],2)],1)},D=[],$=u(x,j,D);const B=$.exports;c.mixin({methods:{t,n}});const E=c.extend(B);new E().$mount("#introjs_settings");
//# sourceMappingURL=intros-adminSettings.mjs.map
